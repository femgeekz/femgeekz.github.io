---
layout: post
title: ! 'Apache Mesos &#58; Writing your own distributed framework'
date: '2015-01-03T17:00:00.000+05:30'
author: Swathi Venkatachala
tags:
- distributed
- mesos
- distributed systems
- linux
- apache mesos
- framework
- pinterest
modified_time: '2015-01-03T21:29:43.094+05:30'
blogger_id: tag:blogger.com,1999:blog-6187879032785791598.post-8119959311094865600
blogger_orig_url: http://femgeekz.blogspot.com/2015/01/apache-mesos-custom-framework.html
comments: true
---

<span style="font-family: Trebuchet MS, sans-serif;">In the previous <a href="http://femgeekz.blogspot.in/2014/12/introduction-and-getting-started-with.html">post</a>, we saw what mesos is, how is it useful and getting started with it. In this post, we shall see how to write your own framework on mesos.</span><br /><span style="font-family: Trebuchet MS, sans-serif;">(In mesos, a framework is any application running on it.)&nbsp;</span><br /><span style="font-family: Trebuchet MS, sans-serif;">This post explains about a framework called "mesos-pinspider" which fetches the user profile information and user board information of a pinterest page of a user.</span><br /><span style="font-family: Trebuchet MS, sans-serif;"><br /></span><br /><h3><span style="font-family: Trebuchet MS, sans-serif;">Mesos Framework</span></h3><span style="font-family: Trebuchet MS, sans-serif;">In general, a Mesos framework has three basic components.&nbsp;</span><br /><span style="font-family: Trebuchet MS, sans-serif;">- <b>Driver</b> which submits the tasks to the framework</span><br /><span style="font-family: Trebuchet MS, sans-serif;">- <b>Scheduler</b> which registers with the master to be offered resources, takes the tasks and runs them on executor</span><br /><span style="font-family: Trebuchet MS, sans-serif;">- <b>Executor</b> process that is launched on slave nodes to run the frameworkâ€™s tasks</span><br /><span style="font-family: Trebuchet MS, sans-serif;"><br /></span><br /><h3><span style="font-family: Trebuchet MS, sans-serif;">Pinspider Framework Example</span></h3><span style="font-family: Trebuchet MS, sans-serif;"><br /></span><span style="font-family: Trebuchet MS, sans-serif;">You may check the code here on <a href="https://github.com/SwathiMystery/mesos-pinspider">github</a>. Let's break it down to PinDriver, PinScheduler and Pin</span><span style="font-family: 'Trebuchet MS', sans-serif;">UserProfileExecutor</span><span style="font-family: Trebuchet MS, sans-serif;">.</span><br /><span style="font-family: Trebuchet MS, sans-serif;"><br /></span><br /><h3><span style="font-family: Trebuchet MS, sans-serif;">Driver</span></h3><span style="font-family: Trebuchet MS, sans-serif;">The driver component of the framework is PinDriver.&nbsp;</span><br /><ul><ul><li><span style="font-family: 'Trebuchet MS', sans-serif;">Create Executor Info</span></li></ul></ul><span style="font-family: Trebuchet MS, sans-serif;">Describe the information about the executor using the Builder pattern and mesos use Google Protocol Buffers for the data interchange. Here, we need to set the executorID, command which is basically a shell command, executed via:</span><span style="font-family: Courier New, Courier, monospace;"> '/bin/sh -c value'</span><span style="font-family: Trebuchet MS, sans-serif;">. Any URIs specified are fetched before executing the command. The name is set by </span><span style="font-family: Courier New, Courier, monospace;">setName()</span><span style="font-family: Trebuchet MS, sans-serif;">. The source is set by </span><span style="font-family: Courier New, Courier, monospace;">setSource()</span><span style="font-family: Trebuchet MS, sans-serif;">, an identifier style string used by frameworks to track the source of an executor. This is useful when it's possible for different executor ids to be related semantically.</span><br /><blockquote class="tr_bq"><span style="font-family: Courier New, Courier, monospace;">Protos.ExecutorInfo userProfileExecutorInfo = Protos.ExecutorInfo.newBuilder().setExecutorId(Protos.ExecutorID.newBuilder().setValue("PinUserProfileExecutor")).setCommand(commandInfoUserProfile).setName("PinUserProfileExecutor Java").setSource("java").build();</span></blockquote><ul><ul><li><span style="font-family: 'Trebuchet MS', sans-serif;">Create Framework Info</span></li></ul></ul><span style="font-family: Trebuchet MS, sans-serif;">Describe the framework information. The user field is used to determine the Unix user that an executor/task should be launched as. If the user field is set to an empty string Mesos will&nbsp;auto-magically&nbsp;set it to the current user. The amount of time that the master will wait for the&nbsp;scheduler to&nbsp;fail-over&nbsp;before removing the framework is specified by&nbsp;</span><span style="font-family: Courier New, Courier, monospace;">setFailoverTimeout()</span><span style="font-family: Trebuchet MS, sans-serif;">. The name of the framework is set by </span><span style="font-family: Courier New, Courier, monospace;">setName()</span><br /><blockquote class="tr_bq"><blockquote class="tr_bq"><span style="font-family: Courier New, Courier, monospace;">Protos.FrameworkInfo.Builder frameworkBuilder = Protos.FrameworkInfo.newBuilder().setFailoverTimeout(120000)</span><span style="font-family: 'Courier New', Courier, monospace;">.setUser("").setName("Pinspider Framework");&nbsp;</span></blockquote></blockquote><ul><ul><li><span style="font-family: 'Trebuchet MS', sans-serif;">Instantiate Scheduler</span></li></ul></ul><span style="font-family: 'Trebuchet MS', sans-serif;">You need to instantiate the Scheduler with the number of tasks that needs to be submitted for the executor to run.</span><br /><blockquote class="tr_bq"><blockquote class="tr_bq"><span style="font-family: Courier New, Courier, monospace;">Scheduler scheduler = args.length == 1 ?</span><span style="font-family: 'Courier New', Courier, monospace;">new PinScheduler(userProfileExecutorInfo,userBoardExecutorInfo) :&nbsp;</span><span style="font-family: 'Courier New', Courier, monospace;">new PinScheduler(userProfileExecutorInfo, userBoardExecutorInfo, Integer.parseInt(args[1]), args[2]);</span></blockquote></blockquote><span style="font-family: Trebuchet MS, sans-serif;"><br /></span><span style="font-family: Trebuchet MS, sans-serif;">Note: Please note that two ExecutorInfo are used ie. one for fetching user profile information and the other one for user board information for demonstration. This explanation involves only one executorinfo - userProfileExecutorInfo</span><br /><ul><ul><li><span style="font-family: 'Trebuchet MS', sans-serif;">Starting the mesos scheduler driver.</span></li></ul></ul><span style="font-family: 'Trebuchet MS', sans-serif;">MesosSchedulerDriver is an implementation of SchedulerDriver which is an abstract interface to connect scheduler to mesos. This is done by managing the&nbsp;life-cycle&nbsp;of the scheduler (&nbsp;start, stop and wait for tasks to finish) and also to interact with Mesos (launch tasks, kill tasks etc).&nbsp;</span><br /><blockquote class="tr_bq"><blockquote class="tr_bq"><span style="font-family: Courier New, Courier, monospace;">MesosSchedulerDriver schedulerDriver = new MesosSchedulerDriver(scheduler,frameworkBuilder.build(), args[0]);</span></blockquote><blockquote class="tr_bq"><span style="font-family: Courier New, Courier, monospace;">int status = schedulerDriver.run() == Protos.Status.DRIVER_STOPPED ? 0 : 1;</span><span style="font-family: 'Courier New', Courier, monospace;">schedulerDriver.stop();</span></blockquote><blockquote class="tr_bq"><span style="font-family: Courier New, Courier, monospace;">System.exit(status);</span></blockquote></blockquote><h3><span style="font-family: Trebuchet MS, sans-serif;">Executor Implementation</span></h3><span style="font-family: 'Trebuchet MS', sans-serif;">The&nbsp;</span><span style="font-family: 'Trebuchet MS', sans-serif;">Executor</span><span style="font-family: 'Trebuchet MS', sans-serif;">&nbsp;component of the framework is PinUserProfileExecutor.</span><br /><span style="font-family: Trebuchet MS, sans-serif;">Executor is a callback interface which is implemented by frameworks' executors. In our implementation, let us concentrate on launchTask()</span><br /><blockquote class="tr_bq"><blockquote class="tr_bq"><span style="font-family: Courier New, Courier, monospace;">@Override public void launchTask(final ExecutorDriver executorDriver, final Protos.TaskInfo taskInfo) {&nbsp;</span></blockquote><blockquote class="tr_bq"><span style="font-family: 'Courier New', Courier, monospace;">}</span></blockquote></blockquote><ul><ul><li><span style="font-family: 'Trebuchet MS', sans-serif;">&nbsp;Set the task status by setting the ID and the state with a builder pattern.</span></li></ul></ul><blockquote class="tr_bq"><blockquote class="tr_bq"><span style="font-family: Courier New, Courier, monospace;">Protos.TaskStatus taskStatus = Protos.TaskStatus.newBuilder().setTaskId(taskInfo.getTaskId())</span><span style="font-family: 'Courier New', Courier, monospace;">.setState(Protos.TaskState.TASK_RUNNING).build();</span></blockquote></blockquote><ul><ul><li><span style="font-family: 'Trebuchet MS', sans-serif;">&nbsp;Send the status update to the framework scheduler retrying as necessary until an acknowledgement has been received or the executor is terminated, in which case, a TASK_LOST status update will be sent.</span></li></ul></ul><blockquote class="tr_bq"><blockquote class="tr_bq"><span style="font-family: Courier New, Courier, monospace;">executorDriver.sendStatusUpdate(taskStatus);</span></blockquote></blockquote><ul><ul><li><span style="font-family: 'Trebuchet MS', sans-serif;">Get the data from the tasks and run your logic.</span></li></ul></ul><blockquote class="tr_bq"><blockquote class="tr_bq"><span style="font-family: Courier New, Courier, monospace;">try {</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">   </span>message = ("userprofile :" + getUserProfileInfo(url)).getBytes();</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>} catch (IOException e) {</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">   </span>LOGGER.error("Error parsing the Pinterest URL :" + e.getMessage());</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>}</span></blockquote></blockquote><ul><ul><li><span style="font-family: 'Trebuchet MS', sans-serif;">&nbsp;Send the framework the message.</span></li></ul></ul><blockquote class="tr_bq"><blockquote class="tr_bq"><span style="font-family: Courier New, Courier, monospace;">executorDriver.sendFrameworkMessage(message);</span></blockquote></blockquote><ul><ul><li><span style="font-family: 'Trebuchet MS', sans-serif;">&nbsp;Mark the state of the task as finished and send the status update to the framework scheduler.</span></li></ul></ul><blockquote class="tr_bq"><blockquote class="tr_bq"><span style="font-family: Courier New, Courier, monospace;">taskStatus = Protos.TaskStatus.newBuilder().setTaskId(taskInfo.getTaskId())</span><span style="font-family: Courier New, Courier, monospace;">&nbsp;.setState(Protos.TaskState.TASK_FINISHED).build();</span><span style="font-family: Courier New, Courier, monospace;">executorDriver.sendStatusUpdate(taskStatus);</span></blockquote></blockquote><ul><ul><li><span style="font-family: 'Trebuchet MS', sans-serif;">&nbsp;main() method to create an instance of MesosExecutorDriver and run&nbsp;</span></li></ul></ul><blockquote class="tr_bq"><blockquote class="tr_bq"><span style="font-family: Courier New, Courier, monospace;">mesosExecutorDriver.run() == Protos.Status.DRIVER_STOPPED ? 0 : 1</span></blockquote></blockquote><h3><span style="font-family: 'Trebuchet MS', sans-serif;">Scheduler Implementation</span></h3><span style="font-family: 'Trebuchet MS', sans-serif;">The Scheduler</span><span style="font-family: 'Trebuchet MS', sans-serif;">&nbsp;component of the framework is Pin</span><span style="font-family: 'Trebuchet MS', sans-serif;">Scheduler</span><span style="font-family: 'Trebuchet MS', sans-serif;">.</span><br /><span style="font-family: Trebuchet MS, sans-serif;">Scheduler is a callback interface to be implemented by frameworks' schedulers. In our implemenation, let us concentrate on resourceOffers(), statusUpdate() and frameworkMessage()</span><br /><ul><li><span style="font-family: Trebuchet MS, sans-serif;">Constructor : construct with the executor information and the number of launch tasks.</span></li></ul><br /><blockquote class="tr_bq"><blockquote class="tr_bq"><span class="Apple-tab-span" style="font-family: 'Trebuchet MS', sans-serif; white-space: pre;"> </span><span style="font-family: Courier New, Courier, monospace;">public PinScheduler(Protos.ExecutorInfo pinUserProfileExecutor , Protos.ExecutorInfo pinUserBoardExecutor ) {<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>this(pinUserProfileExecutor,pinUserBoardExecutor, 5, "http://www.pinterest.com/techcrunch");<br /><span class="Apple-tab-span" style="white-space: pre;"> </span>}</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;"> </span></span></blockquote></blockquote><blockquote class="tr_bq"><blockquote class="tr_bq"><span style="font-family: Courier New, Courier, monospace;">public PinScheduler(Protos.ExecutorInfo pinUserProfileExecutor,Protos.ExecutorInfo pinUserBoardExecutor, &nbsp;int totalTasks, String url) {</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>this.pinUserProfileExecutor = pinUserProfileExecutor;</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>this.pinUserBoardExecutor = pinUserBoardExecutor;</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>this.totalTasks = totalTasks;</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>this.crawlQueue = Collections.synchronizedList(new ArrayList&lt;String&gt;());</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>this.crawlQueue.add(url);</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;"> </span>}</span></blockquote></blockquote><ul><li><span style="font-family: 'Trebuchet MS', sans-serif;">&nbsp;Resource Offers</span></li><ul><li><span style="font-family: 'Trebuchet MS', sans-serif;">&nbsp;A resource offer can be resources like CPU, memory etc. From the offers list, get the scalar value of the resources. We need to give our requirements of resources for the tasks while setting the task info.</span></li></ul></ul><blockquote class="tr_bq"><blockquote class="tr_bq"><span style="font-family: Courier New, Courier, monospace;">for (Protos.Offer offer : list) {</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">   </span>List&lt;Protos.TaskInfo&gt; taskInfoList = new ArrayList&lt;Protos.TaskInfo&gt;();</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">   </span>double offerCpus = 0;</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">   </span>double offerMem = 0;</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">   </span>for (Protos.Resource resource : offer.getResourcesList()) {</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">    </span>if (resource.getName().equals("cpus")) {</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">     </span>offerCpus += resource.getScalar().getValue();</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">    </span>} else if (resource.getName().equals("mem")) {</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">     </span>offerMem += resource.getScalar().getValue();</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">    </span>}</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">   </span>}</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">   </span>LOGGER.info("Received Offer : " + offer.getId().getValue() + " with cpus = " + offerCpus + " and mem ="</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">     </span>+ offerMem);</span></blockquote></blockquote><ul><ul><li><span style="font-family: 'Trebuchet MS', sans-serif;">Create task ID.</span></li></ul></ul><blockquote class="tr_bq"><blockquote class="tr_bq"><span style="font-family: Courier New, Courier, monospace;">Protos.TaskID taskID = Protos.TaskID.newBuilder().setValue(Integer.toString(launchedTasks++)).build();</span></blockquote></blockquote><ul><ul><li><span style="font-family: 'Trebuchet MS', sans-serif;">Create task info by setting task ID, adding resources, setting data and setting executor.</span></li></ul></ul><blockquote class="tr_bq"><blockquote class="tr_bq"><span style="font-family: Courier New, Courier, monospace;">Protos.TaskInfo pinUserProfileTaskInfo = Protos.TaskInfo.newBuilder().setName("task " + taskID.getValue())</span><span style="font-family: Courier New, Courier, monospace;">.setTaskId(taskID).setSlaveId(offer.getSlaveId())</span><span style="font-family: Courier New, Courier, monospace;">.addResources(Protos.Resource.newBuilder().setName("cpus")</span><span style="font-family: Courier New, Courier, monospace;">.setType(</span><span style="font-family: Courier New, Courier, monospace;">Protos.Value.Type.SCALAR)</span><span style="font-family: Courier New, Courier, monospace;">.setScalar(Protos.Value.Scalar</span><span style="font-family: Courier New, Courier, monospace;">.newBuilder().setValue(</span><span style="font-family: Courier New, Courier, monospace;">CPUS_PER_TASK)))</span><span style="font-family: Courier New, Courier, monospace;">.addResources(Protos.Resource.newBuilder().setName("mem")</span><span style="font-family: Courier New, Courier, monospace;">.setType(</span><span style="font-family: Courier New, Courier, monospace;">Protos.Value.Type.SCALAR)</span><span style="font-family: Courier New, Courier, monospace;">.setScalar(Protos.Value.Scalar</span><span style="font-family: Courier New, Courier, monospace;">.newBuilder()</span><span style="font-family: Courier New, Courier, monospace;">.setValue(MEM_PER_TASK)))</span><span style="font-family: Courier New, Courier, monospace;">.setData(ByteString.copyFromUtf8(crawlQueue.get(0)))</span><span style="font-family: Courier New, Courier, monospace;">.setExecutor(Protos.ExecutorInfo.newBuilder(</span><span style="font-family: Courier New, Courier, monospace;">pinUserProfileExecutor))</span><span style="font-family: 'Courier New', Courier, monospace;">.build();</span></blockquote></blockquote><ul><ul><li><span style="font-family: 'Trebuchet MS', sans-serif;">&nbsp;Launch the tasks through the SchedulerDriver.</span></li></ul></ul><blockquote class="tr_bq"><blockquote class="tr_bq"><span style="font-family: Courier New, Courier, monospace;">...<span class="Apple-tab-span" style="white-space: pre;"> </span></span>&nbsp;<span style="font-family: Courier New, Courier, monospace;">taskInfoList.add(pinUserProfileTaskInfo);</span><span style="font-family: Courier New, Courier, monospace;">taskInfoList.add(pinUserBoardTaskInfo);</span><span style="font-family: Courier New, Courier, monospace;">}</span><span style="font-family: Courier New, Courier, monospace;">schedulerDriver.launchTasks(offer.getId(), taskInfoList);</span></blockquote></blockquote><ul><li><span style="font-family: 'Trebuchet MS', sans-serif;">&nbsp;Status update</span></li></ul><span style="font-family: 'Trebuchet MS', sans-serif;">This is invoked when the status of a task has changed ie., a slave is lost and so the task is lost, a task finishes and an executor sends a status update saying so.</span><br /><blockquote class="tr_bq"><blockquote class="tr_bq"><span style="font-family: Courier New, Courier, monospace;">@Override public void statusUpdate(SchedulerDriver schedulerDriver, Protos.TaskStatus taskStatus) {</span><span style="font-family: Courier New, Courier, monospace;">...</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;"> </span>}</span></blockquote></blockquote><ul><ul><li><span style="font-family: 'Trebuchet MS', sans-serif;">Stop the SchedulerDriver if tasks are finished</span></li></ul></ul><blockquote class="tr_bq"><blockquote class="tr_bq"><span class="Apple-tab-span" style="font-family: 'Trebuchet MS', sans-serif; white-space: pre;">  </span><span style="font-family: Courier New, Courier, monospace;">if (taskStatus.getState() == Protos.TaskState.TASK_FINISHED) {</span><span class="Apple-tab-span" style="font-family: 'Courier New', Courier, monospace; white-space: pre;">   </span><span style="font-family: 'Courier New', Courier, monospace;">finishedTasks++;</span><span class="Apple-tab-span" style="font-family: 'Courier New', Courier, monospace; white-space: pre;">   </span><span style="font-family: 'Courier New', Courier, monospace;">LOGGER.info("Finished tasks : " + finishedTasks);</span><span class="Apple-tab-span" style="font-family: 'Courier New', Courier, monospace; white-space: pre;">   </span><span style="font-family: 'Courier New', Courier, monospace;">if (finishedTasks == totalTasks) {</span><span class="Apple-tab-span" style="font-family: 'Courier New', Courier, monospace; white-space: pre;">    </span><span style="font-family: 'Courier New', Courier, monospace;">schedulerDriver.stop();</span><span class="Apple-tab-span" style="font-family: 'Courier New', Courier, monospace; white-space: pre;">   </span><span style="font-family: 'Courier New', Courier, monospace;">}</span><span class="Apple-tab-span" style="font-family: 'Courier New', Courier, monospace; white-space: pre;">  </span><span style="font-family: 'Courier New', Courier, monospace;">}</span></blockquote></blockquote><ul><ul><li><span style="font-family: 'Trebuchet MS', sans-serif;">&nbsp;Abort the SchedulerDriver if the tasks are killed, lost or failed</span></li></ul></ul><blockquote class="tr_bq"><blockquote class="tr_bq"><span class="Apple-tab-span" style="font-family: 'Trebuchet MS', sans-serif; white-space: pre;">  </span><span style="font-family: Courier New, Courier, monospace;">if (taskStatus.getState() == Protos.TaskState.TASK_FAILED<br /><span class="Apple-tab-span" style="white-space: pre;">    </span>|| taskStatus.getState() == Protos.TaskState.TASK_KILLED<br /><span class="Apple-tab-span" style="white-space: pre;">    </span>|| taskStatus.getState() == Protos.TaskState.TASK_LOST) {<br /><span class="Apple-tab-span" style="white-space: pre;">   </span>LOGGER.error("Aborting because the task " + taskStatus.getTaskId().getValue() + " is in unexpected state : "<br /><span class="Apple-tab-span" style="white-space: pre;">     </span>+ taskStatus.getState().getValueDescriptor().getName() + "with reason : " + taskStatus.getReason()<br /><span class="Apple-tab-span" style="white-space: pre;">                          </span> &nbsp;.getValueDescriptor()<br /><span class="Apple-tab-span" style="white-space: pre;">                          </span> &nbsp;.getName()<br /><span class="Apple-tab-span" style="white-space: pre;">     </span>+ " from source : " + taskStatus.getSource().getValueDescriptor().getName() + " with message : "<br /><span class="Apple-tab-span" style="white-space: pre;">     </span>+ taskStatus.getMessage());<br /><span class="Apple-tab-span" style="white-space: pre;">   </span>schedulerDriver.abort();<br /><span class="Apple-tab-span" style="white-space: pre;">  </span>}</span></blockquote></blockquote><ul><li><span style="font-family: 'Trebuchet MS', sans-serif;">&nbsp;Framework Message</span></li></ul><span style="font-family: 'Trebuchet MS', sans-serif;">This is invoked when an executor sends a message.</span><br /><ul><ul><li><span style="font-family: 'Trebuchet MS', sans-serif;">Handle your message</span></li></ul></ul><blockquote class="tr_bq"><blockquote class="tr_bq"><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;"> </span>@Override public void frameworkMessage(SchedulerDriver schedulerDriver, Protos.ExecutorID executorID,</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">   </span>Protos.SlaveID slaveID, byte[] bytes) {</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>String data = new String(bytes);</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>System.out.println(data);</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;">  </span>LOGGER.info("User Profile Information : " + data);</span><span style="font-family: Courier New, Courier, monospace;"><span class="Apple-tab-span" style="white-space: pre;"> </span>}</span></blockquote></blockquote><span style="font-family: Trebuchet MS, sans-serif;">Complete code is available <a href="https://github.com/SwathiMystery/mesos-pinspider">here</a>&nbsp;with the instructions to run and sample output.</span><br />Happy Learning! :)